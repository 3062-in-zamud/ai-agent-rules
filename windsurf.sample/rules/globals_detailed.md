---
trigger: always_on
description: "Detailed global rules for the entire repository"
globs: ["**/*"]
---

---
description: Detailed reference for global rules (manual lookup)
globs:
  - "**/*"
ruleType: Always
---

まず、ユーザーから受け取った指示を確認します：
<指示>
{{instructions}}
<!-- このテンプレート変数はユーザーの入力プロンプトに自動置換されます -->
</指示>

この指示を元に、以下のプロセスに従って作業を進めてください：

---

## 0. ルール読了確認（必須）
- このルールを読み終えたら、以下のように発言すること：
```
**`##### グローバル詳細ルール確認完了！`**
```
- この確認が行われない限り、実装計画書や進捗ログの生成は行ってはならない。

---

## 1. 指示の分析と計画
<タスク分析>
- 主要なタスクを簡潔に要約してください。
- 記載された **守るべきルールのディレクトリ/ファイル** を必ずチェックしてください。
- 重要な要件と制約を特定してください。
- 潜在的な課題をリストアップしてください。
- タスク実行のための具体的なステップを詳細に列挙してください。
- 最初に実装計画書を作成し、ユーザーに承認を得てから進めて下さい。
  - {3. 実装計画書 (implementation_plans/) の運用}を参照ください。
- それらのステップの最適な実行順序を決定してください。
  - 適宜進捗ログを残すようにし、次回の作業時は前回の進捗を確認するようにして下さい。
    - {4. 実装進捗ログの管理}を参照ください。

### 1.1 重複実装の防止
実装前に以下を確認してください。
- 既存の類似機能の有無
- 同名または類似名の関数やコンポーネント
- 重複する API エンドポイント
- 共通化可能な処理の特定

このセクションは後続のプロセス全体を導くものです。十分に詳細かつ包括的に分析してください。
</タスク分析>

---

## 2. タスクの実行
- 特定したステップを一つずつ実行してください。
- 各ステップの完了後、簡潔に進捗ログを残すようにしてください。
- ステップごとに確認をする必要はありません。
  - 詰まった時や自分で解決できない場合に指示を仰いでください。
- 実装時は以下に留意してください。
  - 適切なディレクトリ構造の遵守
  - 命名規則の一貫性維持
  - 共通処理の適切な配置

---

## 3. 実装計画書 (implementation_plans/) の運用

### 3.1 ディレクトリ構成
- **実装を開始する前に必ず下記を作成すること**
  - `implementation_plans/YYYYMMDD_<作業タイトル>/`
  - 上記ディレクトリ内に `YYYYMMDD_<作業タイトル>.md` を配置し、実装計画書を記述する。

### 3.2 実装計画書に必ず含める項目
1. **概要 (Overview)** – 機能やモジュールの目的と背景
2. **スコープ (Scope)** – 対応範囲と今回含まない範囲
3. **完了条件 (Definition of Done / Acceptance Criteria)**
4. **技術的アプローチ (Technical Approach)** – 採用技術と設計方針
5. **タスク分解とスケジュール (Task Breakdown & Timeline)**
6. **リスクと対応策 (Risks & Mitigations)**
7. **関連資料 (References)** – 仕様書・設計書等へのリンク

---

## 4. 実装進捗ログの管理

### 4.1 ログファイル規定
- 同じディレクトリに **連番付き進捗ログ** を追記する。
- ファイル名: `YYYYMMDD_progress_<連番>.md` (例: `20250502_progress_01.md`)

### 4.2 ログ項目
1. **日時 (Date/Time)**
2. **現在の進捗状況 (Current Progress)** – 完了/着手中/次タスク
3. **課題と対応策 (Issues & Actions)**
4. **レビュー・議論内容 (Review/Discussion)**
5. **次のステップ (Next Steps)**

---

## 5. 品質管理と問題対応
- 各タスク完了後に迅速に検証を行うこと。
- エラーや不整合が発生した場合は以下の手順で対応。
  1. 問題の切り分けと原因特定
  2. 対策案の作成と実施
  3. 修正後の動作検証
  4. デバッグログの確認と分析

検証結果は以下の形式で記録する。
- 検証項目 / 期待結果
- 実結果 / 差異
- 必要な対応策

---

## 6. 最終確認
- 全タスク完了後、成果物と指示内容の整合性を確認してください。
- 実装機能に重複がないことを必ず検証してください。

---

## 7. 結果報告フォーマット
```markdown
# 実行結果報告

## 概要
[全体の要約を簡潔に記述]

## 実行ステップ
1. [ステップ1の説明と結果]
2. [ステップ2の説明と結果]
...

## 最終成果物
[成果物の詳細や、該当する場合はリンクなど]

## 課題対応（該当する場合）
- 発生した問題と対応内容
- 今後の注意点

## 注意点・改善提案
- [気づいた点や改善提案があれば記述]
```

---

## 8. 守るべきルールのディレクトリ/ファイル
- `./cursor/rules/dev-rules/*.mdc` のルールを厳守すること。

## 9. 重要な注意事項
- 不明点は作業開始前に必ず確認を取ること。
- 重要な判断が必要な場合はその都度報告し承認を得ること。
- 予期せぬ問題が発生した場合は即座に報告し、対応策を提案すること。
- 明示的に指示されていない変更を行わないこと。
- UI/UX デザイン変更は禁止（レイアウト・色・フォント・間隔等）。必要な場合は事前承認を得ること。
- 技術スタックのバージョンを勝手に変更しないこと。変更が必要な場合は理由を明示し承認を得るまで保留すること。

---
(End of globals_detailed.mdc)
